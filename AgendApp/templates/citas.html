<!DOCTYPE html>
<html lang="es" class="">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Citas - AgendApp</title>
<script src="https://cdn.tailwindcss.com"></script>
<script>
  tailwind.config = {
    darkMode: 'class',
    theme: {
      extend: {
        colors: {
          brand: {
            50: '#f0f9ff',
            100: '#e0f2fe',
            200: '#bae6fd',
            500: '#0ea5e9', // Azul claro brillante (Sky 500)
            600: '#0284c7', // Azul claro profundo (Sky 600)
            700: '#0369a1',
          }
        }
      }
    }
  }
</script>
<style>
  body { font-family: 'Inter', sans-serif; }
  .fade-up {
    transform: translateY(20px);
    opacity: 0;
    animation: fadeUpAnim 0.5s forwards;
  }
  @keyframes fadeUpAnim {
    to { transform: translateY(0); opacity: 1; }
  }
</style>
</head>
<body class="min-h-screen bg-slate-50 dark:bg-gray-950 transition-colors duration-500 flex flex-col items-center px-4 py-10">

<nav class="fixed top-0 left-0 w-full bg-white/80 dark:bg-slate-900/80 backdrop-blur-md shadow-sm py-3 z-50 transition-colors duration-500 border-b border-blue-100 dark:border-slate-800">
  <div class="max-w-6xl mx-auto px-4 flex justify-between items-center">
    <h1 class="text-xl font-bold text-brand-600 dark:text-brand-500 tracking-tight">AgendApp</h1>
    <div class="flex items-center gap-4">
      <button id="themeToggle" class="text-slate-500 dark:text-slate-400 text-xl hover:bg-slate-100 dark:hover:bg-slate-800 p-2 rounded-full transition">ðŸŒ™</button>
      <a href="{{ url_for('form') }}" class="px-5 py-2 rounded-lg bg-brand-500 text-white font-semibold shadow-sm hover:bg-brand-600 transition-all active:scale-95">
        Volver
      </a>
    </div>
  </div>
</nav>
<div class="h-20"></div>

<div class="w-full max-w-4xl bg-white dark:bg-slate-900 rounded-2xl shadow-xl shadow-blue-900/5 p-8 transition-colors duration-500 border border-slate-200 dark:border-slate-800">

  <h1 class="text-3xl font-bold text-slate-900 dark:text-white text-center mb-2 fade-up">
    Mis Citas Agendadas
  </h1>

  <p class="text-slate-500 dark:text-slate-400 text-center mb-8 fade-up">
    Revisa el estado de tus citas con tu correo electrÃ³nico.
  </p>

  <form method="POST" action="{{ url_for('citas') }}" class="bg-blue-50 dark:bg-slate-800/40 p-6 rounded-xl border border-blue-100 dark:border-slate-700 mb-10 fade-up">
    <label class="block text-xs font-bold text-blue-600 dark:text-brand-500 uppercase tracking-widest mb-2">Tu Email</label>
    <div class="flex flex-col sm:flex-row gap-3">
      <input type="email" name="email_cliente" id="email_cliente" required
             value="{{ email_buscado or '' }}"
             placeholder="nombre@correo.com"
             class="flex-1 px-4 py-3 rounded-xl border border-blue-200 dark:border-slate-600 dark:bg-slate-800 dark:text-slate-100 focus:border-brand-500 focus:ring-4 focus:ring-brand-500/10 outline-none transition-all">
      <button type="submit"
              class="bg-brand-500 hover:bg-brand-600 text-white px-8 py-3 rounded-xl font-bold transition-all shadow-lg shadow-brand-500/20">
        Buscar
      </button>
    </div>
  </form>

  {% if citas_cliente is defined and citas_cliente is not none %}

    {% if citas_cliente|length > 0 %}

      <div class="md:hidden flex flex-col gap-4 fade-up">
        {% for cita in citas_cliente %}
        <div class="bg-white dark:bg-slate-800 p-5 rounded-xl border border-slate-200 dark:border-slate-700">
          <div class="flex justify-between items-center mb-4">
             <span class="text-xs font-bold px-2 py-1 rounded bg-blue-100 dark:bg-brand-500/20 text-blue-700 dark:text-brand-400 uppercase">
              {{ cita.tipo_una }}
            </span>
            <span class="text-slate-400 text-sm italic">{{ cita.duracion }} min</span>
          </div>
          <div class="mb-4">
            <h3 class="text-slate-900 dark:text-white font-bold text-lg">{{ cita.date }}</h3>
            <p class="text-slate-500 dark:text-slate-400">{{ cita.hora }}</p>
          </div>
          <a href="{{ url_for('cancelar_cita', timestamp=cita.timestamp) }}"
             onclick="return confirm('Â¿Confirmas la cancelaciÃ³n?');"
             class="text-center block w-full py-2 text-red-500 font-semibold border border-red-100 dark:border-red-900/30 rounded-lg hover:bg-red-50 dark:hover:bg-red-900/10 transition">
             Cancelar Cita
          </a>
        </div>
        {% endfor %}
      </div>

      <div class="hidden md:block fade-up overflow-hidden border border-slate-200 dark:border-slate-700 rounded-xl">
        <table class="min-w-full divide-y divide-slate-200 dark:divide-slate-700">
          <thead class="bg-slate-50 dark:bg-slate-800">
            <tr>
              <th class="px-6 py-4 text-left text-xs font-bold text-slate-500 uppercase tracking-wider">Fecha</th>
              <th class="px-6 py-4 text-left text-xs font-bold text-slate-500 uppercase tracking-wider">Hora</th>
              <th class="px-6 py-4 text-left text-xs font-bold text-slate-500 uppercase tracking-wider">Servicio</th>
              <th class="px-6 py-4 text-center text-xs font-bold text-slate-500 uppercase tracking-wider">AcciÃ³n</th>
            </tr>
          </thead>
          <tbody class="bg-white dark:bg-slate-900 divide-y divide-slate-100 dark:divide-slate-800">
            {% for cita in citas_cliente %}
            <tr class="hover:bg-blue-50/50 dark:hover:bg-slate-800/50 transition-colors">
              <td class="px-6 py-4 whitespace-nowrap text-sm font-semibold text-slate-800 dark:text-slate-200">{{ cita.date }}</td>
              <td class="px-6 py-4 whitespace-nowrap text-sm text-slate-600 dark:text-slate-400">{{ cita.hora }}</td>
              <td class="px-6 py-4 whitespace-nowrap">
                <span class="px-3 py-1 bg-brand-50 dark:bg-brand-500/10 text-brand-700 dark:text-brand-400 text-xs font-bold rounded-full border border-brand-100 dark:border-brand-500/20">
                  {{ cita.tipo_una }}
                </span>
              </td>
              <td class="px-6 py-4 whitespace-nowrap text-center">
                <a href="{{ url_for('cancelar_cita', timestamp=cita.timestamp) }}"
                   onclick="return confirm('Â¿Seguro que quieres cancelar?');"
                   class="text-red-400 hover:text-red-600 font-bold text-sm transition-colors">Eliminar</a>
              </td>
            </tr>
            {% endfor %}
          </tbody>
        </table>
      </div>

    {% else %}
      <div class="text-center py-8 px-6 rounded-2xl border-2 border-dashed border-slate-200 dark:border-slate-700 fade-up">
        <p class="text-slate-500 dark:text-slate-400">
          No hay citas para <span class="text-brand-600 font-bold">{{ email_buscado }}</span>
        </p>
      </div>
    {% endif %}

  {% endif %}

</div>

<script src="{{ url_for('static', filename='js/citas.js') }}"></script>

</body>
</html>